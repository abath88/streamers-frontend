{"ast":null,"code":"import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport axios from 'axios';\nconst initialState = {\n  streamers: [],\n  streamer: null,\n  fetchLoading: false,\n  fetchError: null,\n  addError: null,\n  addLoading: false,\n  voteLoading: false,\n  voteError: null\n};\nconst backendURL = 'http://localhost:3001';\nexport const fetchSteamers = createAsyncThunk('streamer/fetchSteamers', async () => {\n  const config = {\n    headers: {\n      'Content-Type': 'application/json',\n      'Access-Control-Allow-Origin': '*'\n    }\n  };\n  const res = await axios(`${backendURL}/api/streamers`, config);\n  const data = await res.data;\n  return data;\n});\nexport const fetchStreamer = createAsyncThunk('streamer/fetchStreamer', async _ref => {\n  let {\n    id\n  } = _ref;\n  const res = await axios(`${backendURL}/api/streamer/${id}`);\n  const data = await res.data;\n  return data;\n});\nexport const addStreamer = createAsyncThunk('streamer/addStreamer', async (_ref2, _ref3) => {\n  let {\n    name,\n    platform,\n    description\n  } = _ref2;\n  let {\n    getState,\n    rejectWithValue\n  } = _ref3;\n  try {\n    const state = getState();\n    const token = state.auth.token;\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n        'Authorization': \"Bearer \" + token\n      }\n    };\n    const {\n      data\n    } = await axios.post(`${backendURL}/api/streamers`, {\n      name,\n      platform,\n      description\n    }, config);\n    return data;\n  } catch (error) {\n    if (error.response && error.response.data.message) {\n      return rejectWithValue(error.response.data.message);\n    } else {\n      return rejectWithValue(error.message);\n    }\n  }\n});\nexport const voteSteamer = createAsyncThunk('streamer/vote', async (_ref4, _ref5) => {\n  let {\n    id,\n    vote\n  } = _ref4;\n  let {\n    getState,\n    rejectWithValue\n  } = _ref5;\n  try {\n    const state = getState();\n    const token = state.auth.token;\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n        'Authorization': \"Bearer \" + token\n      }\n    };\n    const {\n      data\n    } = await axios.put(`${backendURL}/api/streamer/${id}/vote`, {\n      vote\n    }, config);\n    return data;\n  } catch (error) {\n    if (error.response && error.response.data.message) {\n      return rejectWithValue(error.response.data.message);\n    } else {\n      return rejectWithValue(error.message);\n    }\n  }\n});\nexport const streamerSlice = createSlice({\n  name: 'streamer',\n  initialState,\n  reducers: {},\n  extraReducers: builder => {\n    builder.addCase(fetchSteamers.pending, state => {\n      state.fetchLoading = true;\n    });\n    builder.addCase(fetchSteamers.fulfilled, (state, action) => {\n      state.fetchLoading = false;\n      state.streamers = action.payload.data;\n    });\n    builder.addCase(fetchSteamers.rejected, (state, action) => {\n      state.fetchLoading = false;\n      state.fetchError = action.payload.error.message;\n    });\n    builder.addCase(fetchStreamer.pending, state => {\n      state.fetchLoading = true;\n    });\n    builder.addCase(fetchStreamer.fulfilled, (state, action) => {\n      state.fetchLoading = false;\n      state.streamer = action.payload.data;\n    });\n    builder.addCase(fetchStreamer.rejected, (state, action) => {\n      state.fetchLoading = false;\n      state.fetchError = action.payload.error.message;\n    });\n    builder.addCase(addStreamer.pending, state => {\n      state.addLoading = true;\n    });\n    builder.addCase(addStreamer.fulfilled, (state, action) => {\n      state.addLoading = false;\n      state.streamers.push(action.payload.data);\n      state.addError = null;\n    });\n    builder.addCase(addStreamer.rejected, (state, action) => {\n      state.addLoading = false;\n      console.log(action);\n      state.addError = action.error.message;\n    });\n    builder.addCase(voteSteamer.pending, state => {\n      state.voteLoading = true;\n    });\n    builder.addCase(voteSteamer.fulfilled, (state, action) => {\n      state.voteLoading = false;\n      state.streamer = action.payload.data;\n      state.streamers.map(el => {\n        if (el._id === action.payload.data._id) action.payload.data;else el;\n      });\n    });\n    builder.addCase(voteSteamer.rejected, (state, action) => {\n      state.voteLoading = false;\n      state.voteError = action.error.message;\n    });\n  }\n});\nexport default streamerSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","initialState","streamers","streamer","fetchLoading","fetchError","addError","addLoading","voteLoading","voteError","backendURL","fetchSteamers","config","headers","res","data","fetchStreamer","_ref","id","addStreamer","_ref2","_ref3","name","platform","description","getState","rejectWithValue","state","token","auth","post","error","response","message","voteSteamer","_ref4","_ref5","vote","put","streamerSlice","reducers","extraReducers","builder","addCase","pending","fulfilled","action","payload","rejected","push","console","log","map","el","_id","reducer"],"sources":["/Users/albert/Desktop/frontend-steamers/src/redux/slice/streamerSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from '@reduxjs/toolkit'\nimport axios from 'axios'\n\nconst initialState = {\n  streamers: [],\n  streamer: null,\n  fetchLoading: false,\n  fetchError: null,\n\n  addError: null,\n  addLoading: false,\n\n  voteLoading: false,\n  voteError: null\n}\n\nconst backendURL = 'http://localhost:3001'\n\nexport const fetchSteamers = createAsyncThunk(\n  'streamer/fetchSteamers',\n  async () => {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*',\n      },\n    };\n    const res = await axios(`${backendURL}/api/streamers`, config);\n    const data = await res.data;\n    return data;\n  }\n)\n\nexport const fetchStreamer = createAsyncThunk(\n  'streamer/fetchStreamer',\n  async ({ id }) => {\n    const res = await axios(`${backendURL}/api/streamer/${id}`);\n    const data = await res.data;\n    return data;\n  }\n)\n\nexport const addStreamer = createAsyncThunk(\n  'streamer/addStreamer',\n  async ({ name, platform ,description }, { getState, rejectWithValue }) => {\n    try {\n      const state = getState();\n      const token = state.auth.token;\n      const config = {\n        headers: {\n          'Content-Type': 'application/json',\n          'Access-Control-Allow-Origin': '*',\n          'Authorization': \"Bearer \" + token\n        },\n      };\n      const { data } = await axios.post(\n        `${backendURL}/api/streamers`,\n        { name, platform, description },\n        config\n      );\n      return data;\n    } catch (error) {\n      if (error.response && error.response.data.message) {\n        return rejectWithValue(error.response.data.message)\n      } else {\n        return rejectWithValue(error.message)\n      }\n    }\n  }\n)\n\nexport const voteSteamer = createAsyncThunk(\n  'streamer/vote',\n  async ({ id, vote }, { getState, rejectWithValue }) => {\n    try {\n      const state = getState();\n      const token = state.auth.token;\n      const config = {\n        headers: {\n          'Content-Type': 'application/json',\n          'Access-Control-Allow-Origin': '*',\n          'Authorization': \"Bearer \" + token\n        },\n      };\n      const { data } = await axios.put(\n        `${backendURL}/api/streamer/${id}/vote`,\n        { vote },\n        config\n      );\n      return data;\n    } catch (error) {\n      if (error.response && error.response.data.message) {\n        return rejectWithValue(error.response.data.message)\n      } else {\n        return rejectWithValue(error.message)\n      }\n    }\n  }\n)\n\nexport const streamerSlice = createSlice({\n  name: 'streamer',\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(fetchSteamers.pending, (state) => {\n      state.fetchLoading = true\n    })\n    builder.addCase(fetchSteamers.fulfilled, (state, action) => {\n      state.fetchLoading = false\n      state.streamers = action.payload.data\n    })\n    builder.addCase(fetchSteamers.rejected, (state, action) => {\n      state.fetchLoading = false\n      state.fetchError = action.payload.error.message\n    })\n\n    builder.addCase(fetchStreamer.pending, (state) => {\n      state.fetchLoading = true\n    })\n    builder.addCase(fetchStreamer.fulfilled, (state, action) => {\n      state.fetchLoading = false\n      state.streamer = action.payload.data\n\n    })\n    builder.addCase(fetchStreamer.rejected, (state, action) => {\n      state.fetchLoading = false\n      state.fetchError = action.payload.error.message\n    })\n\n    builder.addCase(addStreamer.pending, (state) => {\n      state.addLoading = true\n    })\n    builder.addCase(addStreamer.fulfilled, (state, action) => {\n      state.addLoading = false\n      state.streamers.push(action.payload.data);\n      state.addError = null;\n    })\n    builder.addCase(addStreamer.rejected, (state, action) => {\n      state.addLoading = false\n      console.log(action)\n      state.addError = action.error.message\n    })\n\n    builder.addCase(voteSteamer.pending, (state) => {\n      state.voteLoading = true\n    })\n    builder.addCase(voteSteamer.fulfilled, (state, action) => {\n      state.voteLoading = false\n      state.streamer = action.payload.data\n      state.streamers.map(el => {\n        if(el._id === action.payload.data._id) action.payload.data\n        else el\n      }) \n    })\n    builder.addCase(voteSteamer.rejected, (state, action) => {\n      state.voteLoading = false\n      state.voteError = action.error.message\n    })\n  }\n})\n\nexport default streamerSlice.reducer"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}